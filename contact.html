<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Contact Weldon Law, LLC | Schedule a Consultation</title>
  <meta name="description" content="Get in touch with Weldon Law, LLC to discuss guardianship, estate planning, probate, and long-term care planning matters in New Jersey." />
  <link rel="stylesheet" href="branded-styles.css" />

  <!-- Page-scoped tweaks (only for contact page) -->
  <style>
    /* Hide both quick-CTA bars on Contact */
    .page-contact .top-cta,
    .page-contact .intake-stick__mobilebar { display: none !important; }

    /* Remove bottom padding reserved for the desktop intake footer on other pages */
    @media (min-width: 1024px) {
      .page-contact { padding-bottom: 0 !important; }
    }
  </style>
</head>

<body class="hero--copy page-contact">
  <!-- Header (same structure/behavior as Home) -->
  <header class="site-header">
    <div class="container nav-container">
      <div class="logo">
        <a href="index.html">
          <img src="images/WeldonLawLogoG.png" alt="Weldon Law logo">
        </a>
      </div>

      <nav class="main-nav" id="nav">
        <button class="menu-toggle" aria-controls="primary-navigation" aria-expanded="false" aria-label="Toggle menu">
          <span class="menu-icon"></span>
        </button>

        <ul class="navbar" id="primary-navigation">
          <li><a href="index.html" aria-current="page">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" aria-haspopup="true" aria-expanded="false">
              Areas of Practice
              <span class="dropdown-arrow">â–¼</span>
            </a>
            <ul class="dropdown-content">
              <li><a href="practice-guardianships.html">Guardianships</a></li>
              <li><a href="practice-ltc.html">Long-Term Care Planning</a></li>
              <li><a href="practice-lp.html">Life Planning (POA/Advance Directive)</a></li>
              <li><a href="practice-legacy.html">Legacy Planning (Wills & Trusts)</a></li>
              <li><a href="practice-probate.html">Probate</a></li>
              <li><a href="practice-general.html">General Counsel & Other Matters</a></li>
            </ul>
          </li>
          <li><a href="news.html">News & Resources</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- No top-cta / no mobile sticky CTA on Contact -->

  <main class="landing">
    <div class="container landing-layout">
      <section class="intro-text">
        <h1>Contact Weldon Law</h1>
        <p class="subtitle">Serving Voorhees, NJ and surrounding communities</p>
        <p class="tagline">Providing strategic legal guidance in guardianship, long-term care planning, estate planning, and probate matters.</p>
        <p><strong>Email:</strong> <a href="mailto:chris@weldon.law">chris@weldon.law</a></p>
        <p><strong>Phone:</strong> <a href="tel:+18568902944">(856) 890-2944</a></p>
      </section>

      <aside class="form-section">
        <h2>Send a Message</h2>

        <form id="intakeFormContact" novalidate>
          <!-- Security fields -->
          <input type="hidden" name="siteKey" value="WL5616!SecureKey" />
          <input type="text" name="company" class="visually-hidden" tabindex="-1" autocomplete="off" aria-hidden="true" />

          <div class="form-row">
            <div class="form-field">
              <label for="first-name">First Name</label>
              <input type="text" id="first-name" name="first-name" autocomplete="given-name" required>
              <div class="field-error" role="alert" aria-live="polite"></div>
            </div>
            <div class="form-field">
              <label for="last-name">Last Name</label>
              <input type="text" id="last-name" name="last-name" autocomplete="family-name" required>
              <div class="field-error" role="alert" aria-live="polite"></div>
            </div>
          </div>

          <div class="form-field">
            <label for="email">Email</label>
            <input type="email" id="email" name="email" autocomplete="email" required>
            <div class="field-error" role="alert" aria-live="polite"></div>
          </div>

          <div class="form-field">
            <label for="phone">Phone Number</label>
            <input type="tel" id="phone" name="phone" inputmode="tel" autocomplete="tel-national">
            <div class="field-error" role="alert" aria-live="polite"></div>
          </div>

          <div class="form-field">
            <label for="interest">Type of Matter</label>
            <select id="interest" name="interest">
              <option value="">-- Please Select --</option>
              <option value="guardianship">Guardianship</option>
              <option value="ltc">Long-Term Care Planning</option>
              <option value="estate">Estate Planning</option>
              <option value="probate">Probate</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="form-field">
            <label for="message">Brief Summary</label>
            <textarea id="message" name="message" rows="5" placeholder="Please describe your situation briefly..."></textarea>
            <div class="field-error" role="alert" aria-live="polite"></div>
          </div>

          <button type="submit">
            <span class="btn-text">Submit</span>
            <span class="btn-loading hidden" aria-hidden="true">Sending...</span>
          </button>

          <div id="contact-status" class="success-inline hidden" role="status" aria-live="polite"></div>
          <div id="contact-error" class="error-inline hidden" role="alert"></div>
        </form>
      </aside>
    </div>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>&copy; 2025 Weldon Law, LLC. All rights reserved.</p>
    </div>
  </footer>

  <!-- JS (shares the same nav & form patterns as Home) -->
  <script>
    // Config
    const FLOW_URL = "https://defaultd5c04a86773448c69c5c579000192e.d0.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/2fd109379c324cd5bbab1546b34dca3c/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=-xN6aeUrA99tUTdgdhnr4g9MpokgDGMuoCeJdynMn_4";

    // Utilities
    const qs = (sel, root = document) => root.querySelector(sel);
    const qsa = (sel, root = document) => Array.from(root.querySelectorAll(sel));
    const digitsOnly = str => (str || '').replace(/[^\d]/g, '');
    const trimLeadingOne = d => (d.length === 11 && d.startsWith('1')) ? d.slice(1) : d;
    const isValidEmail = email => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);

    // Mobile Navigation (same behavior as Home)
    function initMobileNavigation() {
      const toggle = qs('.menu-toggle');
      const navList = qs('#primary-navigation');
      const body = document.body;
      if (!toggle || !navList) return;

      toggle.addEventListener('click', () => {
        const isOpen = navList.classList.toggle('open');
        toggle.setAttribute('aria-expanded', isOpen);
        body.classList.toggle('nav-open', isOpen);
      });

      const dropdownToggle = qs('.dropdown-toggle');
      if (dropdownToggle) {
        dropdownToggle.addEventListener('click', (e) => {
          if (window.innerWidth <= 768) {
            e.preventDefault();
            const dropdown = dropdownToggle.closest('.dropdown');
            const expanded = dropdownToggle.getAttribute('aria-expanded') === 'true';
            dropdownToggle.setAttribute('aria-expanded', String(!expanded));
            dropdown.classList.toggle('expanded');
          }
        });
      }

      // Close on outside click / ESC / resize
      document.addEventListener('click', (e) => {
        if (window.innerWidth <= 768 && navList.classList.contains('open')) {
          if (!e.target.closest('.site-header')) closeMobileNav();
        }
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && navList.classList.contains('open')) {
          closeMobileNav();
          toggle.focus();
        }
      });
      window.addEventListener('resize', () => {
        if (window.innerWidth > 768 && navList.classList.contains('open')) {
          closeMobileNav();
        }
      });

      function closeMobileNav() {
        navList.classList.remove('open');
        toggle.setAttribute('aria-expanded', 'false');
        body.classList.remove('nav-open');
        const dropdown = qs('.dropdown');
        const dt = qs('.dropdown-toggle');
        if (dropdown && dt) {
          dropdown.classList.remove('expanded');
          dt.setAttribute('aria-expanded', 'false');
        }
      }

      // Constrain panel height so the mobile CTA area (hidden here) would align if present
      function setNavMaxHeight() {
        const header = qs('.site-header');
        const viewport = window.innerHeight;
        const headerH = header ? header.getBoundingClientRect().height : 56;
        const maxH = Math.max(180, viewport - headerH);
        navList.style.maxHeight = maxH + 'px';
        navList.style.overflowY = 'auto';
      }
      setNavMaxHeight();
      window.addEventListener('resize', setNavMaxHeight, { passive: true });
      window.addEventListener('orientationchange', setNavMaxHeight, { passive: true });
    }

    // Form helpers (same feel as Home)
    function formatPhoneLive(el) {
      if (!el) return;
      el.addEventListener('input', () => {
        let d = trimLeadingOne(digitsOnly(el.value));
        if (!d) { el.value = ''; return; }
        if (d.length <= 3) el.value = `(${d}`;
        else if (d.length <= 6) el.value = `(${d.slice(0,3)}) ${d.slice(3)}`;
        else el.value = `(${d.slice(0,3)}) ${d.slice(3,6)}-${d.slice(6,10)}`;
      });
    }

    function validateField(field) {
      const wrapper = field.closest('.form-field');
      const errorDiv = wrapper?.querySelector('.field-error');
      let valid = true;
      let msg = '';

      field.removeAttribute('aria-invalid');
      wrapper?.classList.remove('valid','error');
      if (errorDiv) errorDiv.textContent = '';

      if (field.hasAttribute('required') && !field.value.trim()) {
        valid = false; msg = 'This field is required';
      } else if (field.type === 'email' && field.value && !isValidEmail(field.value)) {
        valid = false; msg = 'Please enter a valid email address';
      } else if (field.type === 'tel' && field.value && digitsOnly(field.value).length < 10) {
        valid = false; msg = 'Please enter a valid phone number';
      }

      if (!valid) {
        field.setAttribute('aria-invalid','true');
        wrapper?.classList.add('error');
        if (errorDiv) errorDiv.textContent = msg;
      } else if (field.value.trim()) {
        wrapper?.classList.add('valid');
      }
      return valid;
    }

    function validateForm(form) {
      const fields = form.querySelectorAll('input[required], input[type="email"], input[type="tel"]');
      let ok = true;
      fields.forEach(f => { if (!validateField(f)) ok = false; });
      return ok;
    }

    function setupFormValidation(form) {
      const fields = form.querySelectorAll('input, select, textarea');
      fields.forEach(field => {
        field.addEventListener('blur', () => validateField(field));
        field.addEventListener('input', () => {
          const wrapper = field.closest('.form-field');
          if (wrapper?.classList.contains('error')) {
            setTimeout(() => validateField(field), 250);
          }
        });
      });
    }

    function setButtonLoading(button, loading) {
      const t = button.querySelector('.btn-text');
      const l = button.querySelector('.btn-loading');
      button.disabled = !!loading;
      if (t) t.classList.toggle('hidden', !!loading);
      if (l) l.classList.toggle('hidden', !loading);
    }

    async function submitIntake(form, statusEl, errorEl) {
      if (!validateForm(form)) {
        errorEl.textContent = 'Please correct the errors above';
        errorEl.classList.remove('hidden');
        statusEl.classList.add('hidden');
        return;
      }

      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      data.phone = trimLeadingOne(digitsOnly(data.phone || ''));

      const submitBtn = form.querySelector('button[type="submit"]');
      setButtonLoading(submitBtn, true);
      errorEl.classList.add('hidden');
      statusEl.textContent = 'Sendingâ€¦';
      statusEl.classList.remove('hidden');

      try {
        const response = await fetch(FLOW_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data),
          mode: 'cors'
        });

        const text = await response.clone().text();
        let json = null; try { json = JSON.parse(text); } catch {}

        if (response.ok && json?.success) {
          statusEl.textContent = 'Thanksâ€”check your email for a confirmation.';
          form.reset();
          form.querySelectorAll('.form-field').forEach(f => f.classList.remove('valid','error'));
        } else {
          throw new Error(json?.message || `Server error: ${response.status}`);
        }
      } catch (err) {
        const msg = ('' + err.message).includes('Network')
          ? 'Network issueâ€”please email chris@weldon.law or call (856) 890-2944.'
          : 'Sorry, something went wrong. Please email chris@weldon.law or call (856) 890-2944.';
        errorEl.textContent = msg;
        errorEl.classList.remove('hidden');
        statusEl.classList.add('hidden');
      } finally {
        setButtonLoading(submitBtn, false);
      }
    }

    // Init
    document.addEventListener('DOMContentLoaded', () => {
      initMobileNavigation();

      const form = qs('#intakeFormContact');
      setupFormValidation(form);
      formatPhoneLive(qs('#phone'));

      const statusEl = qs('#contact-status');
      const errorEl  = qs('#contact-error');
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        submitIntake(form, statusEl, errorEl);
      });
    });
  </script>
</body>
</html>
