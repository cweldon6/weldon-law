/* =========================================
   Weldon Law â€” Brand System & Layout
   ========================================= */

/* === CSS Custom Properties === */
:root {
  /* Brand Colors */
  --color-primary: #2c3539;
  --color-accent: #A47864;
  --color-ink: #1F2937;
  --color-ink-strong: #0B1220;
  --color-bg: #FFFFFF;
  --color-bg-soft: #F7F7F5;
  --color-focus: #133978;

  /* Semantic Color Tokens */
  --color-success: #0a5c22;
  --color-danger: #b42318;
  --color-backdrop: #00000066;
  
  /* Calculated Colors */
  --color-border: color-mix(in oklab, var(--color-ink) 20%, var(--color-bg));
  --color-input-border: color-mix(in oklab, var(--color-ink) 20%, var(--color-bg));
  --tile-tint: color-mix(in oklab, var(--color-border) 10%, transparent);

  /* Legacy Aliases */
  --brand-blue: var(--color-primary);
  --brand-gold: var(--color-accent);
  --light-gray: var(--color-bg-soft);
  --text-gray: var(--color-ink);

  /* Typography */
  --font-sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
  --font-serif: "Source Serif 4", Georgia, Cambria, "Times New Roman", Times, serif;

  /* Font Sizes */
  --fs-300: 0.875rem;
  --fs-400: 1rem;
  --fs-500: 1.125rem;
  --fs-600: clamp(1.125rem, 1rem + 1vw, 1.375rem);
  --fs-700: clamp(1.375rem, 1.15rem + 1.6vw, 1.75rem);
  --fs-800: clamp(1.625rem, 1.2rem + 2.6vw, 2.25rem);

  /* Line Heights */
  --lh-tight: 1.25;
  --lh-normal: 1.6;

  /* Spacing Scale */
  --space-1: 0.25rem;
  --space-2: 0.5rem;
  --space-3: 0.75rem;
  --space-4: 1rem;
  --space-5: 1.5rem;
  --space-6: 2rem;
  --space-7: 3rem;
  --space-8: 4rem;

  /* Visual Effects */
  --radius-sm: 6px;
  --radius-md: 12px;
  --shadow-1: 0 1px 3px rgba(0,0,0,.08), 0 4px 12px rgba(0,0,0,.06);
  --shadow-2: 0 4px 6px rgba(0,0,0,.1), 0 10px 15px rgba(0,0,0,.1);

  /* Layout Constraints */
  --max-width: 72rem;
  --max-width-xl: 90rem;
  --max-width-xxl: 100rem;
  --measure: 65ch;
}

/* === Reset & Base === */
*, *::before, *::after { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  color: var(--color-ink);
  background: var(--color-bg);
  font-family: var(--font-sans);
  line-height: var(--lh-normal);
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}

/* Focus */
a:focus-visible,button:focus-visible,input:focus-visible,select:focus-visible,textarea:focus-visible{
  outline:3px solid var(--color-focus);outline-offset:2px;border-radius:4px;
}

/* Layout utility */
.container { width: min(90%, var(--max-width)); margin-inline: auto; }
@media (min-width:1600px){ .container{ width:min(88%, 78rem); } }

/* Typography */
a { color: var(--color-primary); text-decoration: none; }
a:hover { text-decoration: underline; }
h1, h2, h3, [id] { scroll-margin-top: 80px; }

/* Global justified paragraphs, with section-specific overrides below */
p { text-align: justify; hyphens: auto; }

/* === Header & Navigation === */
.site-header {
  position: sticky; top: 0; z-index: 1000;
  background: var(--color-primary); color: #fff; padding: var(--space-3) 0;
}
.nav-container { display:flex; justify-content:space-between; align-items:center; }
.logo img { max-height:64px; height:auto; width:auto; }

/* Primary nav */
.navbar { list-style:none; display:flex; flex-wrap:wrap; gap:1.25rem; margin:0; padding:0; }
.navbar a { color:#fff; font-weight:600; }
.navbar li { position:relative; }

/* Mobile toggle */
.menu-toggle {
  background:transparent; color:#fff; border:0; font-size:1.5rem;
  min-width:44px; min-height:44px; line-height:1; cursor:pointer; display:none;
  position:relative; place-items:center;
}
.menu-toggle .menu-icon,
.menu-toggle .menu-icon::before,
.menu-toggle .menu-icon::after{
  content:""; display:block; width:22px; height:2px; background:#fff;
  transition:transform .2s ease, opacity .2s ease, top .2s ease; position:relative;
}
.menu-toggle .menu-icon::before{ position:absolute; top:-6px; }
.menu-toggle .menu-icon::after{ position:absolute; top:6px; }
.menu-toggle[aria-expanded="true"] .menu-icon{ background:transparent; }
.menu-toggle[aria-expanded="true"] .menu-icon::before{ transform:rotate(45deg); top:0; }
.menu-toggle[aria-expanded="true"] .menu-icon::after{ transform:rotate(-45deg); top:0; }

/* Desktop dropdown */
.dropdown-content{
  display:none; position:absolute; top:2rem; left:0; background:#fff; color:var(--color-ink);
  min-width:220px; border:1px solid var(--color-border); box-shadow:var(--shadow-1);
  z-index:10; border-radius:var(--radius-sm); list-style:none; padding-left:0;
}
.dropdown-content li{ margin:0; }
.dropdown-content a{ display:block; padding:.5rem 1rem; color:var(--color-ink); border-top:1px solid var(--color-border); }
.dropdown-content a:first-child{ border-top:0; }
.dropdown:hover .dropdown-content, .dropdown:focus-within .dropdown-content{ display:block; }
.dropdown > a:focus-visible{ outline:3px solid var(--color-focus); outline-offset:2px; border-radius:4px; }

/* Mobile nav */
@media (max-width:768px){
  .menu-toggle{ display:inline-grid; }
  .navbar{
    display:none; position:absolute; top:100%; left:0; right:0; background:var(--color-primary);
    border-top:1px solid rgba(255,255,255,.1); box-shadow:0 4px 12px rgba(0,0,0,.15);
    flex-direction:column; gap:0; z-index:1000;
  }
  .navbar.open{ display:flex; }
  .navbar a{ display:block; padding:1rem; color:#fff; font-weight:600; border-bottom:1px solid rgba(255,255,255,.1); }
  .navbar a:hover, .navbar a:focus{ background:rgba(255,255,255,.1); text-decoration:none; }

  .dropdown-toggle{ display:flex; justify-content:space-between; align-items:center; }
  .dropdown-arrow{ font-size:.8em; transition:transform .2s ease; }
  .dropdown.expanded .dropdown-arrow{ transform:rotate(180deg); }
  .dropdown-content{ display:none; position:static; background:rgba(255,255,255,.05); border:none; box-shadow:none; border-radius:0; }
  .dropdown.expanded .dropdown-content{ display:block; }
  .dropdown-content a{ padding:.75rem 1.5rem; font-size:.9em; border-bottom:1px solid rgba(255,255,255,.05); }
  .dropdown-content a:last-child{ border-bottom:none; }
  .dropdown:hover .dropdown-content, .dropdown:focus-within .dropdown-content{ display:none; }
  .dropdown.expanded:hover .dropdown-content{ display:block; }

  body.nav-open .top-cta{ display:none; }
  body.nav-open{ overflow:hidden; }
}

/* === Top CTA Bar === */
.top-cta{ background:var(--color-bg-soft); border-bottom:1px solid rgba(0,0,0,.06); font-size:.975rem; }
.top-cta__inner{
  display:grid; grid-template-columns:1fr auto; gap:.75rem 1rem; align-items:center; padding:.5rem 0;
}
.top-cta__actions{ display:flex; align-items:center; gap:.5rem; }
@media (max-width:768px){
  .top-cta__inner{ grid-template-columns:1fr; text-align:center; }
  .top-cta__actions{ justify-content:center; flex-wrap:wrap; }
}
.btn{ display:inline-block; border-radius:999px; padding:.5rem 1rem; text-decoration:none; font-weight:600; line-height:1; }
.btn--outline{ border:1px solid var(--color-primary); color:var(--color-primary); background:transparent; }
.btn--outline:hover{ background: color-mix(in oklab, var(--color-primary) 10%, transparent); }
.btn--phone{ background:var(--color-accent); color:#fff; border:0; }
.btn--phone:hover{ filter:brightness(.95); }

/* === Hero Section === */
.hero--copy .intro-banner{ background:var(--color-bg-soft); }
.intro-banner{ background:var(--color-bg-soft); padding:var(--space-4) 0; position:relative; }
.intro-banner :is(h1, p){ max-width:var(--measure); margin-inline:auto; text-align:left; padding:0 4rem; }
@media (max-width:768px){ .intro-banner :is(h1, p){ padding:0 3rem; } }
.intro-banner .hero-line{ margin:0 0 .25rem 0; line-height:var(--lh-tight); }
.intro-banner .hero-sub{ margin:0; line-height:1.4; }
.intro-banner p{ margin-bottom:1rem; }

/* Rotator */
.hero-rotator{ position:relative; text-align:initial; }
.hero-line, .hero-sub{ transition:opacity .45s ease; will-change:opacity; }
.hero-rotator.is-fading .hero-line, .hero-rotator.is-fading .hero-sub{ opacity:0; }
@media (prefers-reduced-motion:reduce){ .hero-line, .hero-sub{ transition:none; } }

/* Hero Controls (desktop default) */
.hero-controls{
  position:absolute; top:50%; left:0; right:0; transform:translateY(-50%);
  display:flex; justify-content:space-between; align-items:center; pointer-events:none; padding:0 var(--space-2);
}
.hero-controls button{
  width:2.25rem; height:2.25rem; display:grid; place-items:center; border:1px solid var(--color-primary);
  background:rgba(44,53,57,.9); backdrop-filter:blur(8px); border-radius:50%;
  font-size:1.25rem; line-height:1; cursor:pointer; pointer-events:auto; transition:all .2s ease;
  color:#fff; font-weight:300; box-shadow:0 2px 8px rgba(44,53,57,.15);
}
.hero-controls button:hover{ background:var(--color-primary); border-color:var(--color-primary); transform:scale(1.05); box-shadow:0 4px 12px rgba(44,53,57,.25); }
.hero-controls button:active{ transform:scale(.98); }
.hero-controls button:focus-visible{ outline:2px solid rgba(255,255,255,.8); outline-offset:2px; }

/* Center content + readable measure in hero */
.hero--copy .intro-banner .hero-rotator{ width:min(90%, var(--max-width)); margin-inline:auto; padding-inline:0; text-align:center; position:relative; }
.hero--copy .intro-banner .hero-line{ max-width:28ch; margin:0 auto .25rem; }
.hero--copy .intro-banner .hero-sub{ max-width:56ch; margin:0 auto; text-align:center; hyphens:none; -webkit-hyphens:none; -ms-hyphens:none; }
/* remove extra padding on hero text */
.hero--copy .intro-banner :is(h1, p){ padding-inline:0; text-align:center; }

/* >>> FINAL MOBILE OVERRIDE (fix): hide hero arrows on mobile <<< */
@media (max-width:768px){
  .hero-controls{ display:none !important; } /* generic */
  .hero--copy .intro-banner .hero-controls{ display:none !important; } /* beats any more-specific rule */
}

/* === Practice Areas === */
.practice-areas-section{ padding:var(--space-3) 0 var(--space-6); }
@media (max-width:768px){ .practice-areas-section{ padding:var(--space-2) 0 var(--space-5); } }

.practice-areas{ display:grid; gap:var(--space-1); grid-template-columns:1fr; }
@media (min-width:640px){ .practice-areas{ grid-template-columns:repeat(2,1fr); } }
@media (min-width:1024px){ .practice-areas{ grid-template-columns:repeat(3,1fr); } }

.practice-area{
  position:relative; padding:var(--space-5) var(--space-4);
  border:0; border-radius:var(--radius-sm); background: #fff; overflow:hidden;
  transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease, background .2s ease;
  border-left:4px solid var(--color-primary); /* default stripe brand-dark */
  box-shadow:var(--shadow-1);
}
.practice-area:hover, .practice-area:focus-within{
  transform:translateY(-2px); box-shadow:var(--shadow-2); border-left-color:var(--color-accent);
}
.practice-area::before{
  content:""; position:absolute; inset:0; z-index:0; background:var(--pa-bg) center/cover no-repeat; opacity:.22; transition:opacity .2s ease; pointer-events:none;
}
.practice-area::after{
  content:""; position:absolute; inset:0; z-index:0; background:var(--pa-tint, transparent); opacity:0; transition:opacity .2s ease; pointer-events:none;
}
.practice-area:hover::before, .practice-area:focus-within::before{ opacity:.30; }
.practice-area.is-active{ border-left-color:var(--color-accent); box-shadow:var(--shadow-1); }
.practice-area.is-active::after{ opacity:1; }

.practice-area h3, .practice-area p{ position:relative; z-index:1; }
.practice-area h3{ margin:0 0 .35rem; line-height:1.15; font-weight:700; font-size:clamp(1.15rem, 1rem + .7vw, 1.5rem); letter-spacing:.1px; }
.practice-area h3 a{ color:var(--color-primary); text-decoration:none; font-weight:inherit; font-size:inherit; }

.pa-title-main{ display:block; font-weight:inherit; font-size:inherit; }
.pa-title-sub{ display:block; margin-top:.15rem; font-style:italic; font-weight:400; font-size:clamp(.95rem,.9rem + .35vw,1.05rem); opacity:.95; }

.practice-area p{
  margin:.35rem 0 0; font-size:var(--fs-500); line-height:1.5;
  max-height:0; opacity:0; overflow:hidden; transition:max-height .25s ease, opacity .25s ease;
}
.practice-area:hover p, .practice-area:focus-within p, .practice-area.is-active p{ max-height:8rem; opacity:1; }

/* === Bio Section === */
.bio-section{ padding:var(--space-5) 0; }
.bio-section .about-snippet{ display:flex; flex-direction:column; gap:var(--space-4); align-items:center; }
.bio-section .bio-image{ width:180px; height:180px; border-radius:var(--radius-sm); object-fit:cover; flex-shrink:0; }
.bio-section .prose{ max-width:65ch; text-align:left; }
@media (min-width:768px){
  .bio-section .about-snippet{ flex-direction:row; align-items:flex-start; gap:var(--space-6); }
  .bio-section .bio-image{ width:240px; height:240px; flex:0 0 240px; }
  .bio-section .prose{ flex:1; max-width:none; }
}

/* Stop hyphenation in key copy blocks for readability */
.intro-banner .hero-line,
.intro-banner .hero-sub,
.bio-section .prose p,
.info-grid .card-collapsible p{
  hyphens:none; -webkit-hyphens:none; -ms-hyphens:none;
}

/* === Info Grid / Home Cards === */
.info-grid{ display:grid; gap:var(--space-3); padding:var(--space-6) 0; }
@media (min-width:900px){ .info-grid{ grid-template-columns:1fr .8fr; align-items:start; } }

.info-grid > .card-collapsible{
  background:#fff; padding:var(--space-6); border-radius:var(--radius-md);
  border-left:4px solid var(--color-accent); box-shadow:var(--shadow-1);
  transition:transform .2s ease, box-shadow .2s ease;
}
.info-grid > .card-collapsible:hover{ transform:translateY(-2px); box-shadow:var(--shadow-2); }
.info-grid > .card-collapsible h2{ color:var(--color-primary); margin-top:0; margin-bottom:var(--space-4); font-size:var(--fs-700); }
.info-grid .card-toggle{ margin-top:var(--space-1); background:transparent; border:1px solid var(--color-border); border-radius:9999px; padding:.5rem .85rem; font:inherit; cursor:pointer; transition:background .15s ease, border-color .15s ease, transform .15s ease; }
.info-grid .card-toggle:hover{ background:var(--color-bg-soft); transform:translateY(-1px); }
.info-grid .card-toggle:focus-visible{ outline:2px solid var(--color-focus); outline-offset:2px; }

/* === Forms === */
form{ display:grid; gap:.75rem; }
.form-row{ display:grid; gap:.75rem; }
@media (min-width:600px){ .form-row{ grid-template-columns:1fr 1fr; } }
.form-field{ position:relative; margin-bottom:var(--space-2); }
.form-field label{ display:block; font-weight:600; margin-bottom:var(--space-1); color:var(--color-ink-strong); }
.field-error{ font-size:var(--fs-300); color:var(--color-danger); margin-top:var(--space-1); min-height:1.2em; }
input, select, textarea{
  padding:.6rem; font-size:var(--fs-400); border:1px solid var(--color-input-border);
  border-radius:6px; width:100%; background:#fff;
}
textarea{ resize:vertical; }
input:focus, select:focus, textarea:focus{ border-color:var(--color-primary); box-shadow:0 0 0 3px color-mix(in srgb, var(--color-primary) 25%, transparent); }
.is-error{ border-color:var(--color-danger)!important; }
button[type="submit"]{
  padding:.75rem 1rem; background:var(--color-primary); color:#fff; font-size:var(--fs-400);
  font-weight:700; border:none; border-radius:6px; cursor:pointer; min-height:44px;
}
button[type="submit"]:hover{ filter:brightness(1.05); }

.form-help{ font-size:var(--fs-300); color:#444; }
.form-error{ font-size:var(--fs-300); color:var(--color-danger); }
.small-subtext{ font-size:var(--fs-300); color:#444; margin-top:.25rem; }

/* Status */
.success-inline{
  margin-top:.5rem; color:var(--color-success);
  background:color-mix(in oklab, var(--color-success) 10%, #fff);
  border:1px solid color-mix(in oklab, var(--color-success) 25%, #fff);
  padding:.5rem .75rem; border-radius:6px; font-size:var(--fs-400);
}
.error-inline{
  margin-top:.5rem; color:var(--color-danger);
  background:color-mix(in oklab, var(--color-danger) 10%, #fff);
  border:1px solid color-mix(in oklab, var(--color-danger) 25%, #fff);
  padding:.5rem .75rem; border-radius:6px; font-size:var(--fs-400);
}

/* === Mobile Intake Sheet === */
.intake-stick__mobilebar{
  position:fixed; inset-inline:0; bottom:0; z-index:1100;
  background:#ffffffF2; backdrop-filter:saturate(120%) blur(6px);
  border-top:1px solid var(--color-border); display:flex; align-items:center; justify-content:center;
  min-height:56px; padding:.5rem 1rem calc(.5rem + env(safe-area-inset-bottom));
}
.intake-stick__cta{
  display:inline-flex; align-items:center; gap:.5rem; font-weight:700; border:1px solid var(--color-primary);
  background:var(--color-accent); color:#fff; padding:.6rem 1rem; border-radius:999px; text-decoration:none; min-height:44px;
}
.intake-stick__cta:focus-visible{ outline:3px solid var(--color-focus); }

/* Mobile Sheet Modal */
.intake-sheet{ position:fixed; inset:0; z-index:1200; display:none; background:var(--color-backdrop); }
.intake-sheet[aria-hidden="false"]{ display:block; }
.intake-sheet__panel{
  position:absolute; left:0; right:0; bottom:0; background:#fff; border-top-left-radius:var(--radius-md);
  border-top-right-radius:var(--radius-md); box-shadow:var(--shadow-1); padding:var(--space-2);
  max-height:85vh; overflow:auto;
}
.intake-sheet__close{
  position:absolute; right:1rem;
  font-size: 1.25rem;
  width: 44px;
  height: 44px;
  line-height: 44px;
  text-align: center;
  border-radius: 6px;
}

/* Form Layout Variants (mobile sheet) */
.intake-form__row { display: grid; gap: 0.75rem; }
.intake-form__row--split { grid-template-columns: 1fr 1fr; }

.intake-form__meta {
  margin-top: var(--space-3);
  font-size: var(--fs-300);
  color: #666;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}
.intake-form__meta a { color: var(--color-primary); text-decoration: underline; }

/* === Desktop Footer Intake === */
.intake-footer { display: none; }

@media (min-width: 1024px) {
  .intake-footer {
    display: block;
    position: fixed;
    bottom: 0; left: 0; right: 0;
    background: var(--color-primary);
    color: #fff;
    box-shadow: 0 -2px 6px rgba(0,0,0,.2);
    z-index: 9999;
    padding: 0.5rem 1rem;
  }

  .intake-footer__form,
  .intake-footer__row {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    max-width: var(--max-width);
    margin: 0 auto;
    flex-wrap: nowrap;
  }

  .intake-footer__form input,
  .intake-footer__form select {
    padding: 0.5rem 0.6rem;
    border: 1px solid var(--color-input-border);
    border-radius: 6px;
    flex: 1 1 140px;
    min-width: 140px;
    background: #fff;
  }

  .intake-footer__submit {
    background: var(--color-accent);
    color: #fff;
    font-weight: 700;
    padding: 0.55rem 1rem;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    flex: 0 0 auto;
    min-height: 44px;
  }

  /* Reserve space for fixed footer */
  body { padding-bottom: 86px; }
}

/* Hide desktop intake on small screens */
@media (max-width: 768px) {
  .intake-bar,
  .intake-panel,
  #intakePanel,
  .intake-footer {
    display: none !important;
  }
}

/* === Footer === */
.site-footer {
  background: var(--color-primary);
  color: #fff;
  text-align: center;
  padding: var(--space-4) 0;
  font-size: var(--fs-300);
}

/* === Utilities === */
.hidden { display: none !important; }

.visually-hidden,
.vh {
  position: absolute !important;
  clip: rect(1px,1px,1px,1px);
  clip-path: inset(50%);
  width: 1px; height: 1px;
  overflow: hidden; white-space: nowrap;
}

.vf { display: contents; }

/* === Validation States === */
.form-field.valid input,
.form-field.valid select,
.form-field.valid textarea { border-color: var(--color-success); }

.form-field.error input,
.form-field.error select,
.form-field.error textarea { border-color: var(--color-danger); }

/* === Print === */
@media print {
  body { color: #000; background: #fff; }
  .site-header,
  .site-footer,
  .top-cta,
  .intake-stick__mobilebar,
  .intake-footer { display: none !important; }
  a { color: #000; text-decoration: underline; }
  input, select, textarea { border: 1px solid #000; }
}

/* === Reduced Motion === */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: .01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: .01ms !important;
  }
}
