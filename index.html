<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Weldon Law, LLC | Guardianship, Estate & Elder Law in New Jersey</title>
  <meta name="description" content="Weldon Law, LLC provides experienced, compassionate counsel in guardianship, estate planning, probate, and long-term care planning throughout New Jersey." />

  <!-- Enhanced SEO Meta Tags -->
  <meta property="og:title" content="Weldon Law, LLC | Guardianship, Estate & Elder Law in New Jersey" />
  <meta property="og:description" content="Experienced, compassionate counsel in guardianship, estate planning, probate, and long-term care planning throughout New Jersey." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://weldon.law/" />
  <meta property="og:image" content="https://weldon.law/images/og-image.jpg" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Weldon Law, LLC | Elder Law Attorney in New Jersey" />
  <meta name="twitter:description" content="Expert guidance in guardianship, estate planning, and elder law matters." />

  <!-- Local Business Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "LegalService",
    "name": "Weldon Law, LLC",
    "description": "Experienced elder law attorney providing guardianship, estate planning, probate, and long-term care planning services in New Jersey.",
    "url": "https://weldon.law",
    "telephone": "+1-856-890-2944",
    "email": "chris@weldon.law",
    "address": { "@type": "PostalAddress", "addressLocality": "Voorhees", "addressRegion": "NJ", "addressCountry": "US" },
    "areaServed": { "@type": "State", "name": "New Jersey" },
    "serviceType": ["Guardianship", "Estate Planning", "Probate", "Long-Term Care Planning"],
    "founder": { "@type": "Person", "name": "Christopher R. Weldon", "jobTitle": "Attorney" }
  }
  </script>

  <link rel="stylesheet" href="branded-styles.css" />
  <link rel="preload" href="images/WeldonLawLogoG.png" as="image" />

  <script>window.INTAKE_PROXY = '/api/intake';</script>
</head>
<body class="hero--copy">

  <!-- Top utility CTA bar -->
  <section class="top-cta" role="region" aria-label="Quick contact">
    <div class="container top-cta__inner">
      <div class="top-cta__prompt">
        <strong>Have a question?</strong> Start here and hear back fast.
      </div>
      <div class="top-cta__actions">
        <a href="#" id="ctaGetHelp" class="btn btn--outline" role="button">Submit Inquiry →</a>
        <a class="btn btn--phone" href="tel:+18568902944" aria-label="Call Weldon Law at (856) 890-2944">
          (856) 890-2944
        </a>
      </div>
    </div>
  </section>

  <!-- Main site header -->
  <header class="site-header">
    <div class="container nav-container">
      <div class="logo">
        <a href="index.html"><img src="images/WeldonLawLogoG.png" alt="Weldon Law logo" /></a>
      </div>
      <nav class="main-nav" id="nav">
        <button class="menu-toggle" aria-controls="primary-navigation" aria-expanded="false" aria-label="Toggle menu">☰</button>
        <ul class="navbar" id="primary-navigation">
          <li><a href="index.html" aria-current="page">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li class="dropdown">
            <a href="#" aria-haspopup="true" aria-expanded="false">Areas of Practice</a>
            <ul class="dropdown-content">
              <li><a href="practice-guardianships.html">Guardianships</a></li>
              <li><a href="practice-ltc.html">Long-Term Care Planning</a></li>
              <li><a href="practice-lp.html">Life Planning (POA/Advance Directive)</a></li>
              <li><a href="practice-legacy.html">Legacy Planning (Wills & Trusts)</a></li>
              <li><a href="practice-probate.html">Probate</a></li>
              <li><a href="practice-general.html">General Counsel & Other Matters</a></li>
            </ul>
          </li>
          <li><a href="news.html">News & Resources</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Sticky Intake (mobile) -->
  <section class="intake-stick" role="complementary" aria-label="Quick intake">
    <div class="intake-stick__mobilebar" aria-hidden="false">
      <a href="#intakeSheet" class="intake-stick__cta" id="openIntakeMobile" role="button" aria-controls="intakeSheet" aria-expanded="false">
        Get help now →
      </a>
    </div>
    <div class="intake-sheet" id="intakeSheet" aria-hidden="true" aria-modal="true" role="dialog" aria-label="Intake form">
      <div class="intake-sheet__panel" role="document">
        <button class="intake-sheet__close" id="closeIntakeMobile" aria-label="Close">✕</button>
        <h2>How can we help?</h2>
        <form id="intakeFormStickyMobile" novalidate>
          <input type="hidden" name="siteKey" value="WL5616!SecureKey" />
          <input type="text" name="company" class="visually-hidden" tabindex="-1" autocomplete="off" aria-hidden="true" />

          <div class="intake-form__row intake-form__row--split">
            <div class="form-field">
              <label for="sm-first-name">First name*</label>
              <input id="sm-first-name" name="first-name" autocomplete="given-name" required />
              <div class="field-error" role="alert" aria-live="polite"></div>
            </div>
            <div class="form-field">
              <label for="sm-last-name">Last name*</label>
              <input id="sm-last-name" name="last-name" autocomplete="family-name" required />
              <div class="field-error" role="alert" aria-live="polite"></div>
            </div>
          </div>

          <div class="form-field">
            <label for="sm-email">Email*</label>
            <input id="sm-email" name="email" type="email" autocomplete="email" required />
            <div class="field-error" role="alert" aria-live="polite"></div>
          </div>

          <div class="form-field">
            <label for="sm-phone">Phone</label>
            <input id="sm-phone" name="phone" type="tel" inputmode="tel" autocomplete="tel-national" />
            <div class="field-error" role="alert" aria-live="polite"></div>
          </div>

          <div class="form-field">
            <label for="sm-interest">Type of matter</label>
            <select id="sm-interest" name="interest">
              <option value="">-- Please Select --</option>
              <option value="guardianship">Guardianship</option>
              <option value="ltc">Long-Term Care Planning</option>
              <option value="estate">Estate Planning</option>
              <option value="probate">Probate</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="form-field">
            <label for="sm-message">Brief summary</label>
            <textarea id="sm-message" name="message" rows="5" placeholder="Please describe your situation briefly..."></textarea>
          </div>

          <button type="submit"><span class="btn-text">Submit</span><span class="btn-loading hidden" aria-hidden="true">Sending...</span></button>
          <div class="small-subtext">We'll reply promptly. No obligation.</div>

          <div class="intake-form__meta">
            <a href="/privacy.html">Privacy + terms</a>
            <span class="form-help">Submitting this form does not create an attorney–client relationship. Please avoid confidential details.</span>
          </div>

          <div id="sm-status" class="success-inline hidden" role="status" aria-live="polite"></div>
          <div id="sm-error" class="error-inline hidden" role="alert"></div>
        </form>
      </div>
    </div>
  </section>

  <main id="main-content">
    <!-- HERO / INTRO (rotating messages) -->
    <section class="intro-banner">
      <div class="container hero-rotator" aria-live="polite">
        <h1 class="hero-line"></h1>
        <p class="hero-sub"></p>

        <div class="hero-controls">
          <button class="hero-prev" type="button" aria-label="Previous message">‹</button>
          <div class="hero-dots" role="tablist" aria-label="Hero messages"></div>
          <button class="hero-next" type="button" aria-label="Next message">›</button>
        </div>

        <!-- Message data in source for SEO -->
        <template id="heroMessages">
          <div data-h1="Compassionate, precise elder law counsel—rooted in your community"
               data-sub="Every matter is approached with the care it deserves, regardless of asset level or complexity."
               data-target="all"></div>

          <div data-h1="Life vs. Legacy"
               data-sub="Take control now—not from the grave."
               data-target="lp,legacy"></div>

          <div data-h1="Protecting dignity. Preserving independence."
               data-sub="Guidance in guardianship, planning, and care when it matters most."
               data-target="guard,ltc"></div>

          <div data-h1="Harnessing technology to improve access and outcomes"
               data-sub="Secure digital intake, e-signatures, and clear updates—so your matter moves efficiently and you stay informed."
               data-target="probate,general"></div>
        </template>
      </div>
    </section>

    <!-- PRACTICE AREAS (6 tiles) -->
    <section class="container" style="padding: var(--space-6) 0;">
      <h2>Areas of Practice</h2>
      <div class="practice-areas">
  <div class="practice-area" data-pa="lp"     style="--pa-bg:url('images/pa-life.jpg')">
    <h3><a href="practice-lp.html">Life Planning (POA/Advance Directive)</a></h3>
    <p>Planning for in-life decision-making and authority if you can’t act.</p>
  </div>

  <div class="practice-area" data-pa="guard"  style="--pa-bg:url('images/pa-guardianships.jpg')">
    <h3><a href="practice-guardianships.html">Guardianships</a></h3>
    <p>Establishing and administering guardianships with diligence and care.</p>
  </div>

  <div class="practice-area" data-pa="ltc"    style="--pa-bg:url('images/pa-ltc.jpg')">
    <h3><a href="practice-ltc.html">Long-Term Care Planning</a></h3>
    <p>Protecting assets while aligning care needs and benefits.</p>
  </div>

  <div class="practice-area" data-pa="legacy" style="--pa-bg:url('images/pa-legacy.jpg')">
    <h3><a href="practice-legacy.html">Legacy Planning (Wills & Trusts)</a></h3>
    <p>Directing your estate and preserving your intent for loved ones.</p>
  </div>

  <div class="practice-area" data-pa="probate" style="--pa-bg:url('images/pa-probate.jpg')">
    <h3><a href="practice-probate.html">Probate</a></h3>
    <p>Guidance through estate administration and court procedures.</p>
  </div>

  <div class="practice-area" data-pa="general" style="--pa-bg:url('images/pa-general.jpg')">
    <h3><a href="practice-general.html">General Counsel & Other Matters</a></h3>
    <p>Related elder-law and fiduciary issues tailored to your situation.</p>
  </div>
</div>

    </section>

    <!-- BIO -->
    <section class="container bio-section" style="padding: var(--space-5) 0;">
      <div class="about-snippet">
        <img src="images/christopher-weldon-headshot2.jpg" alt="Portrait of Christopher R. Weldon, Esquire, elder law attorney" class="bio-image" width="120" height="150" loading="lazy" />
        <p>
          Christopher R. Weldon, Esquire&mdash;founder of Weldon Law&mdash;has dedicated his legal career to advocating for vulnerable individuals and those who support them. He focuses on guardianship; life &amp; legacy planning; long-term care preparation; probate matters; and other related elder law issues.*
        </p>
        <p>
          With more than a decade of elder law experience and involvement in over 1,000 guardianship and fiduciary matters, Chris is recognized for his compassionate approach and commitment to resolving conflict efficiently. His background includes service as a State Regulatory Attorney with the New Jersey Office of the Public Guardian, legislative advocacy to improve elder care and guardianship laws, and presentations to judicial and professional audiences.
        </p>
        <p><a href="about.html">Learn more →</a></p>
      </div>
    </section>

    <!-- TRUST / QUICK FACTS -->
    <section class="container" style="padding: var(--space-6) 0;">
      <div class="info-grid" style="padding: 0;">
        <div>
          <h2>Why families choose Weldon Law</h2>
          <ul class="services-list">
            <li><strong>1,000+ guardianship/fiduciary matters</strong> handled across NJ courts</li>
            <li><strong>Transparent process</strong> and timely communication</li>
            <li><strong>Neighborly, steady counsel</strong> when decisions feel overwhelming</li>
          </ul>
        </div>
        <div>
          <h2>How we work</h2>
          <ol class="services-list">
            <li><strong>Start here:</strong> Send a short intake (mobile sheet or “Get help now →”)</li>
            <li><strong>You will hear back quickly</strong> with next steps and a short call</li>
            <li><strong>Clear plan</strong> for your matter and timelines</li>
          </ol>
        </div>
      </div>
    </section>

    <!-- FAQ + RESOURCES -->
    <section class="container" style="padding: var(--space-6) 0;">
      <div class="info-grid" style="padding: 0;">
        <div class="faq-content">
          <h2>Frequently Asked Questions</h2>
          <div class="faq-list">
            <details>
              <summary>Do I need an attorney for a guardianship?</summary>
              <p>It depends. The process involves court filings, medical certifications, and hearings. Together we will map the steps and timeline.</p>
            </details>
            <details>
              <summary>How fast can we start?</summary>
              <p>After you send the intake, we typically respond the same day or next business day with next steps.</p>
            </details>
            <details>
              <summary>Is the first message confidential?</summary>
              <p>Submitting the form does not create an attorney–client relationship. Please avoid sharing sensitive details initially; you will be advised if anything further is needed.</p>
            </details>
          </div>
        </div>
        <div class="firm-services">
          <h2>Resources</h2>
          <ul class="services-list">
            <li><a href="news.html">News &amp; Guides</a></li>
            <li><a href="contact.html">Office &amp; Hours</a></li>
          </ul>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>&copy; 2025 Weldon Law, LLC. All rights reserved.</p>
    </div>
  </footer>

  <!-- Desktop Fixed Footer Intake -->
  <section class="intake-footer" role="complementary" aria-label="Quick intake footer">
    <form id="intakeFormFooterDesktop" class="intake-footer__form" novalidate>
      <input type="hidden" name="siteKey" value="WL5616!SecureKey" />
      <input type="text" name="company" class="visually-hidden" tabindex="-1" autocomplete="off" aria-hidden="true" />
      <div class="intake-footer__row">
        <label class="vf"><span class="vh">Last name</span><input id="ft-last-name" name="last-name" placeholder="Last name" required /></label>
        <label class="vf"><span class="vh">First name</span><input id="ft-first-name" name="first-name" placeholder="First name" required /></label>
        <label class="vf"><span class="vh">Email</span><input id="ft-email" name="email" type="email" placeholder="Email" required /></label>
        <label class="vf"><span class="vh">Phone</span><input id="ft-phone" name="phone" type="tel" inputmode="tel" placeholder="Phone" /></label>
        <label class="vf">
          <span class="vh">Type of matter</span>
          <select id="ft-interest" name="interest" aria-label="Type of matter">
            <option value="">Matter type</option>
            <option value="guardianship">Guardianship</option>
            <option value="ltc">Long-Term Care Planning</option>
            <option value="estate">Estate Planning</option>
            <option value="probate">Probate</option>
            <option value="other">Other</option>
          </select>
        </label>
        <button type="submit" class="intake-footer__submit" aria-label="Submit intake">
          <span class="btn-text">Submit</span><span class="btn-loading hidden" aria-hidden="true">Sending...</span>
        </button>
      </div>
      <div id="intakeFooterPanel" class="intake-footer__statusline" aria-live="polite">
        <span id="ft-status" class="success-inline hidden"></span>
        <span id="ft-error" class="error-inline hidden" role="alert"></span>
        <span class="small-subtext">We'll reply promptly. No obligation.</span>
      </div>
    </form>
  </section>

  <!-- === JavaScript === -->
  <script>
  /* ===== Config ===== */
  const FLOW_URL = "https://prod-121.westus.logic.azure.com:443/workflows/2fd109379c324cd5bbab1546b34dca3c/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=GH5F3oVR83EzQ2fzn0l0yUzqs9bmVpHFZP0D0lJgBV8";

  /* ===== Error messages ===== */
  const errorMessages = {
    'first-name': 'Please enter your first name',
    'last-name': 'Please enter your last name',
    'email': 'Please enter a valid email address',
    'phone': 'Please enter a valid phone number'
  };

  /* ===== Menu toggle ===== */
  (function(){
    const toggle = document.querySelector('.menu-toggle');
    const navList = document.getElementById('primary-navigation');
    if (toggle && navList) {
      toggle.addEventListener('click', () => {
        const isOpen = navList.classList.toggle('open');
        toggle.setAttribute('aria-expanded', isOpen);
      });
    }
  })();

  /* ===== Utilities ===== */
  const qs = (s, r=document) => r.querySelector(s);
  const qsa = (s, r=document) => Array.from(r.querySelectorAll(s));
  const digitsOnly = s => (s || '').replace(/[^\d]/g, '');
  const trimLeadingOne = d => (d.length === 11 && d.startsWith('1')) ? d.slice(1) : d;

  function formatPhoneLive(el) {
    if (!el) return;
    el.addEventListener('input', () => {
      let d = trimLeadingOne(digitsOnly(el.value));
      if (!d) { el.value = ''; return; }
      if (d.length <= 3) el.value = `(${d}`;
      else if (d.length <= 6) el.value = `(${d.slice(0,3)}) ${d.slice(3)}`;
      else el.value = `(${d.slice(0,3)}) ${d.slice(3,6)}-${d.slice(6,10)}`;
    });
  }
  const isValidEmail = email => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);

  /* ===== Validation ===== */
  function validateField(field) {
    const fieldContainer = field.closest('.form-field');
    const errorDiv = fieldContainer?.querySelector('.field-error');
    let isValid = true, errorMessage = '';

    field.removeAttribute('aria-invalid');
    fieldContainer?.classList.remove('valid', 'error');
    if (errorDiv) errorDiv.textContent = '';

    if (field.hasAttribute('required') && !field.value.trim()) {
      isValid = false; errorMessage = errorMessages[field.name] || 'This field is required';
    } else if (field.type === 'email' && field.value && !isValidEmail(field.value)) {
      isValid = false; errorMessage = 'Please enter a valid email address';
    } else if (field.type === 'tel' && field.value && digitsOnly(field.value).length < 10) {
      isValid = false; errorMessage = 'Please enter a valid phone number';
    }

    if (!isValid) {
      field.setAttribute('aria-invalid', 'true');
      fieldContainer?.classList.add('error');
      if (errorDiv) errorDiv.textContent = errorMessage;
    } else if (field.value.trim()) {
      fieldContainer?.classList.add('valid');
    }
    return isValid;
  }

  function validateForm(form) {
    const fields = form.querySelectorAll('input[required], input[type="email"], input[type="tel"]');
    let ok = true; fields.forEach(f => { if (!validateField(f)) ok = false; });
    return ok;
  }

  function setupFormValidation(form) {
    if (!form) return;
    const fields = form.querySelectorAll('input, select, textarea');
    fields.forEach(field => {
      field.addEventListener('blur', () => validateField(field));
      field.addEventListener('input', () => {
        const fc = field.closest('.form-field');
        if (fc?.classList.contains('error')) setTimeout(() => validateField(field), 300);
      });
    });
  }

  function setButtonLoading(button, loading) {
    const textSpan = button.querySelector('.btn-text');
    const loadingSpan = button.querySelector('.btn-loading');
    button.disabled = !!loading;
    if (textSpan) textSpan.classList.toggle('hidden', !!loading);
    if (loadingSpan) loadingSpan.classList.toggle('hidden', !loading);
  }

  /* ===== Mobile sheet ===== */
  const sheet = qs('#intakeSheet');
  const openMobile = qs('#openIntakeMobile');
  const closeMobile = qs('#closeIntakeMobile');

  function trapFocus(container, enabled) {
    if (!container) return;
    const focusable = () => container.querySelectorAll('a[href], button, textarea, input, select, [tabindex]:not([tabindex="-1"])');
    function onKey(e) {
      if (!enabled) return;
      if (e.key === 'Escape') { closeMobileSheet(); return; }
      if (e.key !== 'Tab') return;
      const nodes = Array.from(focusable()).filter(n => !n.disabled && n.offsetParent !== null);
      if (!nodes.length) return;
      const first = nodes[0], last = nodes[nodes.length-1];
      if (e.shiftKey && document.activeElement === first) { last.focus(); e.preventDefault(); }
      else if (!e.shiftKey && document.activeElement === last) { first.focus(); e.preventDefault(); }
    }
    if (container.__trapHandler) document.removeEventListener('keydown', container.__trapHandler);
    container.__trapHandler = onKey;
    document.addEventListener('keydown', onKey);
  }

  function openMobileSheet() {
    if (!sheet) return;
    sheet.setAttribute('aria-hidden', 'false');
    openMobile?.setAttribute('aria-expanded', 'true');
    document.body.style.overflow = 'hidden';
    setTimeout(() => qs('#sm-first-name')?.focus(), 100);
    trapFocus(sheet, true);
  }
  function closeMobileSheet() {
    if (!sheet) return;
    sheet.setAttribute('aria-hidden', 'true');
    openMobile?.setAttribute('aria-expanded', 'false');
    document.body.style.overflow = '';
    trapFocus(sheet, false);
    openMobile?.focus();
  }
  openMobile?.addEventListener('click', (e) => { e.preventDefault(); openMobileSheet(); });
  closeMobile?.addEventListener('click', closeMobileSheet);
  sheet?.addEventListener('click', (e) => { if (e.target === sheet) closeMobileSheet(); });

  /* ===== CTA routing ===== */
  (function () {
    const cta = document.getElementById('ctaGetHelp');
    if (!cta) return;
    cta.addEventListener('click', (e) => {
      e.preventDefault();
      if (window.innerWidth <= 768) openMobileSheet();
      else window.location.href = 'contact.html';
    });
  })();

  /* ===== Submit ===== */
  async function submitIntake(form, statusEl, errorEl) {
    const submitButton = form.querySelector('button[type="submit"]');
    if (!validateForm(form)) {
      errorEl.textContent = 'Please correct the errors above';
      errorEl.classList.remove('hidden'); statusEl.classList.add('hidden');
      return;
    }
    const data = Object.fromEntries(new FormData(form).entries());
    data.phone = trimLeadingOne(digitsOnly(data.phone || ''));

    setButtonLoading(submitButton, true);
    errorEl.classList.add('hidden'); statusEl.textContent = 'Sending…';
    statusEl.classList.add('success-inline'); statusEl.classList.remove('hidden');

    try {
      const response = await fetch(FLOW_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data), mode: 'cors' });
      const txt = await response.clone().text();
      let json = null; try { json = JSON.parse(txt); } catch {}
      if (response.ok && json?.success) {
        statusEl.textContent = 'Thanks—check your email for a confirmation.';
        form.reset(); form.querySelectorAll('.form-field').forEach(f => f.classList.remove('valid','error'));
        if (form.id === 'intakeFormStickyMobile') setTimeout(closeMobileSheet, 2000);
      } else { throw new Error(json?.message || `Server error: ${response.status}`); }
    } catch (err) {
      console.error(err);
      errorEl.textContent = ('' + err.message).includes('Network')
        ? 'Network issue—please email chris@weldon.law or call (856) 890-2944.'
        : 'Sorry, something went wrong. Please email chris@weldon.law or call (856) 890-2944.';
      errorEl.classList.add('error-inline'); errorEl.classList.remove('hidden');
      statusEl.classList.remove('success-inline'); statusEl.classList.add('hidden');
    } finally {
      setButtonLoading(submitButton, false);
    }
  }

  function initializeIntakeForm(formId, statusId, errorId, phoneId) {
    const form = qs('#' + formId); if (!form) return;
    setupFormValidation(form); formatPhoneLive(qs('#' + phoneId));
    const statusEl = qs('#' + statusId); const errorEl = qs('#' + errorId);
    form.addEventListener('submit', (e) => { e.preventDefault(); submitIntake(form, statusEl, errorEl); });
  }
  initializeIntakeForm('intakeFormStickyMobile', 'sm-status', 'sm-error', 'sm-phone');
  initializeIntakeForm('intakeFormFooterDesktop', 'ft-status', 'ft-error', 'ft-phone');

  function adjustBottomPaddingMobile() {
    const bar = document.querySelector('.intake-stick__mobilebar'); if (!bar) return;
    const h = bar.getBoundingClientRect().height || 56;
    document.body.style.paddingBottom = (window.innerWidth <= 768) ? (h + 8) + 'px' : '';
  }
  window.addEventListener('resize', adjustBottomPaddingMobile);
  window.addEventListener('orientationchange', adjustBottomPaddingMobile);
  adjustBottomPaddingMobile();

  if ('requestIdleCallback' in window) {
    requestIdleCallback(() => {
      const link = document.createElement('link'); link.rel = 'prefetch'; link.href = 'about.html'; document.head.appendChild(link);
    });
  }

  /* ===== Hero rotator + tile linking + per-message tint ===== */
  (function () {
    const wrap = document.querySelector('.hero-rotator');
    if (!wrap) return;

    const h1  = wrap.querySelector('.hero-line');
    const p   = wrap.querySelector('.hero-sub');
    const tpl = document.getElementById('heroMessages');

    // Practice Areas
    const paContainer = document.querySelector('.practice-areas');
    const paTiles = paContainer ? Array.from(paContainer.children) : [];
    paTiles.forEach((tile, idx) => (tile.dataset.origIndex ??= String(idx)));
    const paByKey = paTiles.reduce((m, tile) => {
      const key = (tile.getAttribute('data-pa') || '').trim(); if (key) m[key] = tile; return m;
    }, {});

    // Messages (allow multiple targets via comma, or "all")
    const messages = Array.from(tpl?.content?.children || []).map(n => ({
      h1: n.getAttribute('data-h1') || '',
      sub: n.getAttribute('data-sub') || '',
      targets: (n.getAttribute('data-target') || '').split(',').map(s => s.trim()).filter(Boolean)
    })).filter(m => m.h1);

    if (!messages.length) return;

    const prevBtn  = wrap.querySelector('.hero-prev');
    const nextBtn  = wrap.querySelector('.hero-next');
    const dotsWrap = wrap.querySelector('.hero-dots');

    let i = 0, timer = null;
    const DURATION = 6500;
    const FADE_MS  = 450;
    const prefersReduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    // Per-message tint palette (all gold for now)
    const TINTS = [
      'rgba(201,161,59,0.12)',
      'rgba(201,161,59,0.12)',
      'rgba(201,161,59,0.12)',
      'rgba(201,161,59,0.12)'
    ];

    // Build dots
    const dots = [];
    if (dotsWrap && messages.length > 1) {
      messages.forEach((_, idx) => {
        const b = document.createElement('button');
        b.type = 'button'; b.className = 'hero-dot';
        b.setAttribute('role', 'tab');
        b.setAttribute('aria-selected', idx === 0 ? 'true' : 'false');
        b.setAttribute('aria-label', `Show message ${idx + 1} of ${messages.length}`);
        dotsWrap.appendChild(b); dots.push(b);
      });
    }
    function updateDots(active) { dots.forEach((d, idx) => d.setAttribute('aria-selected', idx === active ? 'true' : 'false')); }

    function insertAt(container, el, index) {
      const ref = container.children[index] || null;
      if (el && el !== ref) container.insertBefore(el, ref);
    }

    function clearTiles() {
      paTiles.forEach(t => {
        t.classList.remove('is-active');
        t.style.removeProperty('--pa-tint');
      });
    }
    function restoreOriginalOrder() {
      if (!paContainer || !paTiles.length) return;
      const sorted = Array.from(paTiles).sort((a, b) => (+a.dataset.origIndex) - (+b.dataset.origIndex));
      sorted.forEach(t => paContainer.appendChild(t));
    }

    // detect true single-column grid (works at any breakpoint)
    function isSingleColumn() {
      if (!paContainer) return false;
      const cols = (getComputedStyle(paContainer).gridTemplateColumns || '')
        .split(' ')
        .filter(Boolean).length;
      return cols <= 1;
    }

    function applyFor(idx) {
      const msg = messages[idx % messages.length];
      const tint = TINTS[idx % TINTS.length] || 'rgba(201,161,59,0.12)';
      const targets = msg.targets;
      const isAll = targets.length === 1 && targets[0].toLowerCase() === 'all';

      clearTiles();

      if (isAll) {
        // Message 1: expand + tint ALL, keep default order
        restoreOriginalOrder();
        paTiles.forEach(t => {
          t.classList.add('is-active');
          t.style.setProperty('--pa-tint', tint);
        });
        return;
      }

      // Else: highlight two tiles (first & second) – expand + tint both
      const firstTile  = paByKey[targets[0]];
      const secondTile = paByKey[targets[1]];
      if (firstTile)  { firstTile.classList.add('is-active');  firstTile.style.setProperty('--pa-tint', tint); }
      if (secondTile) { secondTile.classList.add('is-active'); secondTile.style.setProperty('--pa-tint', tint); }

      if (isSingleColumn()) {
        // Single-column: move FIRST to slot 0, then SECOND to slot 1
        if (firstTile)  insertAt(paContainer, firstTile, 0);
        if (secondTile) insertAt(paContainer, secondTile, 1);
      } else {
        // Multi-column (tablet/desktop): keep original order
        restoreOriginalOrder();
      }
    }

    function render(idx, immediate = false) {
      const msg = messages[idx % messages.length];
      if (!msg) return;

      if (immediate) {
        h1.textContent = msg.h1;
        p.textContent  = msg.sub;
        updateDots(idx);
        applyFor(idx);
        return;
      }

      wrap.classList.add('is-fading');
      setTimeout(() => {
        h1.textContent = msg.h1;
        p.textContent  = msg.sub;
        wrap.classList.remove('is-fading');
        updateDots(idx);
        applyFor(idx);
      }, FADE_MS);
    }

    function start() {
      if (prefersReduce || messages.length < 2) return;
      stop(); timer = setInterval(() => { i = (i + 1) % messages.length; render(i); }, DURATION);
    }
    function stop() { if (timer) { clearInterval(timer); timer = null; } }

    // Init
    render(i, true); start();

    // Pause on hover/focus
    wrap.addEventListener('mouseenter', stop);
    wrap.addEventListener('mouseleave', start);
    wrap.addEventListener('focusin', stop);
    wrap.addEventListener('focusout', start);

    // Buttons
    prevBtn?.addEventListener('click', () => { stop(); i = (i - 1 + messages.length) % messages.length; render(i); start(); });
    nextBtn?.addEventListener('click', () => { stop(); i = (i + 1) % messages.length; render(i); start(); });

    // Dots
    dots.forEach((dot, idx) => {
      dot.addEventListener('click', () => { stop(); i = idx; render(i); start(); });
      dot.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft')  { e.preventDefault(); prevBtn?.click(); dots[Math.max(0, idx - 1)]?.focus(); }
        if (e.key === 'ArrowRight') { e.preventDefault(); nextBtn?.click(); dots[Math.min(messages.length - 1, idx + 1)]?.focus(); }
      });
    });

    // Re-apply on resize (for single-column reordering)
    window.addEventListener('resize', () => applyFor(i));
    document.addEventListener('visibilitychange', () => { if (document.hidden) stop(); else start(); });
  })();
  </script>
</body>
</html>
